(function(k,e){typeof exports=="object"&&typeof module<"u"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):(k=typeof globalThis<"u"?globalThis:k||self,e(k["@vietscript/parser"]={}))})(this,function(k){"use strict";var At=Object.defineProperty;var Ct=(k,e,N)=>e in k?At(k,e,{enumerable:!0,configurable:!0,writable:!0,value:N}):k[e]=N;var a=(k,e,N)=>(Ct(k,typeof e!="symbol"?e+"":e,N),N);var e=(s=>(s.VAR="Var",s.CONST="Const",s.LET="Let",s.IF="If",s.ELSE="Else",s.FOR="For",s.WHILE="While",s.DO="Do",s.BREAK="Break",s.CONTINUE="Continue",s.RETURN="Return",s.SWITCH="Switch",s.CASE="Case",s.DEFAULT="Default",s.TRY="Try",s.CATCH="Catch",s.FINALLY="Finally",s.THROW="Throw",s.FUNCTION="Function",s.CLASS="Class",s.INTERFACE="Interface",s.ENUM="Enum",s.TYPE="Type",s.IMPORT="Import",s.EXPORT="Export",s.FROM="From",s.AS="As",s.IN="In",s.OF="Of",s.IS="Is",s.NEW="New",s.THIS="This",s.SUPER="Super",s.TRUE="True",s.FALSE="False",s.NULL="Null",s.VOID="Void",s.ANY="Any",s.NUMBER="Number",s.STRING="String",s.BOOLEAN="Boolean",s.OBJECT="Object",s.ARRAY="Array",s.NAN="NaN",s.INFINITY="Infinity",s.UNDEFINED="Undefined",s.STATIC="Static",s.PUBLIC="Public",s.PRIVATE="Private",s.PROTECTED="Protected",s.ABSTRACT="Abstract",s.EXTENDS="Extends",s.IMPLEMENTS="Implements",s.GET="Get",s.SET="Set",s.CONSTRUCTOR="Constructor",s.YIELD="Yield",s.AWAIT="Await",s.ASYNC="Async",s.DELETE="Delete",s.TYPEOF="Typeof",s.INSTANCEOF="Instanceof",s.WITH="With",s.DEBUGGER="Debugger",s.IDENTIFIER="Identifier",s))(e||{});const N="\\u00C0\\u00C1\\u00C2\\u00C3\\u00C8\\u00C9\\u00CA\\u00CC\\u00CD\\u00D2\\u00D3\\u00D4\\u00D5\\u00D9\\u00DA\\u0102\\u0110\\u0128\\u0168\\u01A0\\u00E0\\u00E1\\u00E2\\u00E3\\u00E8\\u00E9\\u00EA\\u00EC\\u00ED\\u00F2\\u00F3\\u00F4\\u00F5\\u00F9\\u00FA\\u0103\\u0111\\u0129\\u0169\\u01A1\\u01AF\\u0102\\u1EA0\\u1EA2\\u1EA4\\u1EA6\\u1EA8\\u1EAA\\u1EAC\\u1EAE\\u1EB0\\u1EB2\\u1EB4\\u1EB6\\u1EB8\\u1EBA\\u1EBC\\u1EC0{2}\\u1EC2\\u01B0\\u0103\\u1EA1\\u1EA3\\u1EA5\\u1EA7\\u1EA9\\u1EAB\\u1EAD\\u1EAF\\u1EB1\\u1EB3\\u1EB5\\u1EB7\\u1EB9\\u1EBB\\u1EBD\\u1EC1{2}\\u1EC3\\u1EC4\\u1EC6\\u1EC8\\u1ECA\\u1ECC\\u1ECE\\u1ED0\\u1ED2\\u1ED4\\u1ED6\\u1ED8\\u1EDA\\u1EDC\\u1EDE\\u1EE0\\u1EE2\\u1EE4\\u1EE6\\u1EE8\\u1EEA\\u1EC5\\u1EC7\\u1EC9\\u1ECB\\u1ECD\\u1ECF\\u1ED1\\u1ED3\\u1ED5\\u1ED7\\u1ED9\\u1EDB\\u1EDD\\u1EDF\\u1EE1\\u1EE3\\u1EE5\\u1EE7\\u1EE9\\u1EEB\\u1EEC\\u1EEE\\u1EF0\\u1EF2\\u1EF4\\u00DD\\u1EF6\\u1EF8\\u1EED\\u1EEF\\u1EF1\\u1EF3\\u1EF5\\u1EF7\\u1EF9",W=[new RegExp(`^[a-zA-Z${N}]+(\\s[a-zA-Z${N}]+)*`),e.IDENTIFIER],p=[[/^\s+/,null],[/^\/\/.*/,null],[/^\/\*[\S\s]*?\*\//,null],[/^\[/,"["],[/^]/,"]"],[/^\(/,"("],[/^\)/,")"],[/^{/,"{"],[/^}/,"}"],[/^;/,";"],[/^,/,","],[/^===/,"==="],[/^==/,"=="],[/^!==/,"!=="],[/^!=/,"!="],[/^=/,"="],[/^\?/,"?"],[/^\?\.?/,"?."],[/^:/,":"],[/^\.{3}/,"..."],[/^\./,"."],[/^\+\+/,"++"],[/^\+/,"+"],[/^--/,"--"],[/^-/,"-"],[/^~/,"~"],[/^!/,"!"],[/^\*/,"*"],[/^\//,"/"],[/^%/,"%"],[/^\*\*/,"**"],[/^\?\?/,"??"],[/^#/,"#"],[/^>>>=/,">>>="],[/^>>>/,">>>"],[/^>>/,">>"],[/^>>=/,">>="],[/^<<=/,"<<="],[/^<</,"<<"],[/^<=/,"<="],[/^>=/,">="],[/^</,"<"],[/^>/,">"],[/^&&/,"&&"],[/^\|\|/,"||"],[/^&/,"&"],[/^\^/,"^"],[/^\|/,"|"],[/^\*=/,"*="],[/^\//,"/="],[/^%=/,"%="],[/^\+=/,"+="],[/^-=/,"-="],[/^&=/,"&="],[/^\^=/,"^="],[/^\|=/,"|="],[/^\*\*=/,"**="],[/^=>/,"=>"],[/^\b(var|khai b\u00E1o)\b/,e.VAR],[/^\b(break|ph\u00E1 v\u00F2ng l\u1EB7p)\b/,e.BREAK],[/^\b(do|th\u1EF1c hi\u1EC7n)\b/,e.DO],[/^\binstanceof\b/,e.INSTANCEOF],[/^\b(typeof|ki\u1EC3u c\u1EE7a)\b/,e.TYPEOF],[/^\b(switch|duy\u1EC7t)\b/,e.SWITCH],[/^\b(case|tr\u01B0\u1EDDng h\u1EE3p)\b/,e.CASE],[/^\b(if|n\u1EBFu)\b/,e.IF],[/^\b(else|kh\u00F4ng th\u00EC)/,e.ELSE],[/^\bnew\b/,e.NEW],[/^\b(catch|b\u1EAFt l\u1ED7i)\b/,e.CATCH],[/^\b(finally|cu\u1ED1i c\u00F9ng)\b/,e.FINALLY],[/^\b(return|tr\u1EA3 v\u1EC1)/,e.RETURN],[/^\bvoid\b/,e.VOID],[/^\b(continue|ti\u1EBFp t\u1EE5c)\b/,e.CONTINUE],[/^\bfor\b/,e.FOR],[/^\b(while|khi m\u00E0)\b/,e.WHILE],[/^\bdebugger\b/,e.DEBUGGER],[/^\b(function|h\u00E0m)\b/,e.FUNCTION],[/^\bthis\b/,e.THIS],[/^\bwith\b/,e.WITH],[/^\b(default|m\u1EB7c \u0111\u1ECBnh)\b/,e.DEFAULT],[/^\b(throw|b\u00E1o l\u1ED7i)\b/,e.THROW],[/^\b(delete|xo\u00E1)\b/,e.DELETE],[/^\b(in|trong)\b/,e.IN],[/^\b(try|th\u1EED)/,e.TRY],[/^\bas\b/,e.AS],[/^\b(from|t\u1EEB)\b/,e.FROM],[/^const|h\u1EB1ng s\u1ED1/,e.CONST],[/^\b(class|l\u1EDBp)\b/,e.CLASS],[/^\b(super|kh\u1EDFi t\u1EA1o cha)\b/,e.SUPER],[/^\b(constructor|kh\u1EDFi t\u1EA1o)\b/,e.CONSTRUCTOR],[/^\benum\b/,e.ENUM],[/^\b(extends|k\u1EBF th\u1EEBa)\b/,e.EXTENDS],[/^\b(export|xu\u1EA5t)\b/,e.EXPORT],[/^\b(import|nh\u1EADp)\b/,e.IMPORT],[/^\b(async|b\u1EA5t \u0111\u1ED3ng b\u1ED9)/,e.ASYNC],[/^\b(await|ch\u1EDD)\b/,e.AWAIT],[/^\byield\b/,e.YIELD],[/^\bimplements\b/,e.IMPLEMENTS],[/^\blet\b/,e.LET],[/^\bprivate\b/,e.PRIVATE],[/^\bpublic\b/,e.PUBLIC],[/^\binterface\b/,e.INTERFACE],[/^\bprotected\b/,e.PROTECTED],[/^\bstatic\b/,e.STATIC],[/^(\d+(\.|)(\d+|)([Ee]([+-]|)\d+|))/,e.NUMBER],[/^"[^"]*"/,e.STRING],[/^'[^']*'/,e.STRING],[/^`[^`]*`/,e.STRING],[/^\bnull\b/,e.NULL],[/^\bNaN\b/,e.NAN],[/^\b(undefined|kh\u00F4ng x\u00E1c \u0111\u1ECBnh)\b/,e.UNDEFINED],[/^\b(true|false)\b/,e.BOOLEAN],W];class m{constructor(t){a(this,"parser");a(this,"cursor");this.parser=t,this.cursor=0}isEOF(){return this.cursor===this.parser.syntax.length}hasMoreTokens(){return this.cursor<this.parser.syntax.length}getNextToken(t=!1){if(!this.hasMoreTokens())return null;const n=this.parser.syntax.slice(this.cursor);for(const[i,o]of p){const c=this.match(i,n);if(c!==null)return o===null?this.getNextToken():{type:o,value:c,start:this.cursor-String(c).length,end:this.cursor}}throw new SyntaxError(`Unexpected token: "${n[0]}"`)}match(t,n){const i=t.exec(n);return i===null?null:(this.cursor+=i[0].length,i[0])}}class H{constructor(t){a(this,"type","EmptyStatement");t.eat(";")}}class h{constructor(t){a(this,"type","Identifier");a(this,"name");var n;this.name=String((n=t.eat(e.IDENTIFIER))==null?void 0:n.value)}}class T{constructor(t){a(this,"type","BlockStatement");a(this,"body");const n=[];t.eat("{"),n.push(...new C(t,["}"]).body),t.eat("}"),this.body=n}}class D{constructor(t,n=!1,i=!1){a(this,"type","FunctionExpression");a(this,"id");a(this,"expression");a(this,"generator");a(this,"async");a(this,"params");a(this,"body");var d,b,y;let o=i,c=!1;((d=t.lookahead)==null?void 0:d.type)===e.ASYNC&&!i&&(t.eat(e.ASYNC),o=!0),n||t.eat(e.FUNCTION),((b=t.lookahead)==null?void 0:b.type)==="*"&&(t.eat("*"),c=!0),t.eat("(");const l=[];for(;((y=t.lookahead)==null?void 0:y.type)!==")";)l.length>0&&t.eat(","),l.push(new h(t));t.eat(")");const u=new T(t);this.id=null,this.expression=!1,this.generator=c,this.async=o,this.params=l,this.body=u}}class F{constructor(t,n,i,o,c,l){a(this,"type","MethodDefinition");a(this,"static");a(this,"computed");a(this,"key");a(this,"kind");a(this,"value");this.static=n,this.computed=o,this.kind=l||"method",this.key=c,this.value=new D(t,!0,i)}}class r{constructor(t){a(this,"type","BooleanLiteral");a(this,"value");a(this,"raw");a(this,"start");a(this,"end");const n=t.eat(e.BOOLEAN);this.start=n.start,this.end=n.end;const i=n.value==="true";this.value=i,this.raw=String(i)}}class Y{constructor(t){a(this,"type","NaNLiteral");a(this,"value");a(this,"raw");a(this,"start");a(this,"end");const n=t.eat(e.NAN);this.start=n.start,this.end=n.end,this.value=Number.NaN,this.raw=e.NAN}}class G{constructor(t){a(this,"type","NullLiteral");a(this,"value");a(this,"raw");a(this,"start");a(this,"end");const n=t.eat("Null");this.start=n.start,this.end=n.end,this.value=null,this.raw="null"}}class P{constructor(t){a(this,"type","NumericLiteral");a(this,"value");a(this,"raw");a(this,"start");a(this,"end");const n=t.eat(e.NUMBER);this.start=n.start,this.end=n.end,this.value=Number(n.value),this.raw=String(n.value)}}class M{constructor(t){a(this,"type","StringLiteral");a(this,"value");a(this,"raw");a(this,"start");a(this,"end");const n=t.eat(e.STRING);this.start=n.start,this.end=n.end;const i=String(n.value).slice(1,-1);this.value=i,this.raw=JSON.stringify(i)}}class V{constructor(t){a(this,"type","UndefinedLiteral");a(this,"value");a(this,"raw");a(this,"start");a(this,"end");const n=t.eat(e.UNDEFINED);this.start=n.start,this.end=n.end,this.value=void 0,this.raw="undefined"}}class O{constructor(t){a(this,"type","Literal");a(this,"value");a(this,"raw");var i;let n;switch((i=t.lookahead)==null?void 0:i.type){case e.NUMBER:{n=new P(t);break}case e.STRING:{n=new M(t);break}case e.BOOLEAN:{n=new r(t);break}case e.NAN:{n=new Y(t);break}case e.NULL:{n=new G(t);break}case e.UNDEFINED:{n=new V(t);break}}this.value=n.value,this.raw=n.raw}}class z{constructor(t){a(this,"type","DoWhileStatement");a(this,"body");a(this,"test");t.eat(e.DO),this.body=new T(t),t.eat(e.WHILE),t.eat("("),this.test=new E(t),t.eat(")")}}class ${constructor(t){a(this,"type","BreakStatement");a(this,"label");var i;t.eat(e.BREAK);let n=null;((i=t.lookahead)==null?void 0:i.type)===e.IDENTIFIER&&(n=new h(t).name),this.label=n}}class q{constructor(t){a(this,"type","ContinueStatement");a(this,"label");var i;t.eat(e.BREAK);let n=null;((i=t.lookahead)==null?void 0:i.type)===e.IDENTIFIER&&(n=new h(t).name),this.label=n}}class X{constructor(t){a(this,"type","ReturnStatement");a(this,"argument");t.eat(e.RETURN);const n=new E(t);this.argument=n}}class J{constructor(t){a(this,"type","ThrowStatement");a(this,"argument");t.eat(e.THROW);const n=new E(t);this.argument=n}}class Z{constructor(t){a(this,"type","DebuggerStatement");t.eat(e.DEBUGGER)}}class _{constructor(t){a(this,"type","SwitchStatement");a(this,"discriminant");a(this,"cases",[]);var n,i,o,c,l,u;for(t.eat(e.SWITCH),t.eat("("),this.discriminant=new E(t),t.eat(")"),t.eat("{");((n=t.lookahead)==null?void 0:n.type)!==e.DEFAULT&&((i=t.lookahead)==null?void 0:i.type)!=="}";){let d=!1;t.eat(e.CASE);const b=new E(t);for(t.eat(":");((o=t.lookahead)==null?void 0:o.type)!==e.CASE&&((c=t.lookahead)==null?void 0:c.type)!==e.DEFAULT&&((l=t.lookahead)==null?void 0:l.type)!=="}";)this.cases.push({type:"SwitchCase",test:b,consequent:new C(t,[e.CASE,e.DEFAULT,"}"]).body}),d=!0;d||this.cases.push({type:"SwitchCase",test:b,consequent:[]})}((u=t.lookahead)==null?void 0:u.type)===e.DEFAULT&&(t.eat(e.DEFAULT),t.eat(":"),this.cases.push({type:"SwitchCase",test:null,consequent:new C(t).body})),t.eat("}")}}class Q{constructor(t){var n;switch((n=t.lookahead)==null?void 0:n.type){case e.DO:case e.WHILE:case e.FOR:{Object.assign(this,new L(t));break}case e.SWITCH:{Object.assign(this,new _(t));break}}}}class g{constructor(t){a(this,"type","IfStatement");a(this,"test");a(this,"consequent");a(this,"alternate");var n,i,o,c,l;t.eat(e.IF),t.eat("("),this.test=((n=t.lookahead)==null?void 0:n.type)===e.IDENTIFIER?new h(t):new E(t),t.eat(")"),this.consequent=((i=t.lookahead)==null?void 0:i.type)==="{"?new T(t):new w(t),((o=t.lookahead)==null?void 0:o.type)===e.ELSE&&(t.eat(e.ELSE),((c=t.lookahead)==null?void 0:c.type)===e.IF?this.alternate=new g(t):this.alternate=((l=t.lookahead)==null?void 0:l.type)==="{"?new T(t):new w(t))}}class K{constructor(t){a(this,"type","CatchClause");a(this,"body");a(this,"param",null);var n;t.eat(e.CATCH),((n=t.lookahead)==null?void 0:n.type)==="("&&(t.eat("("),this.param=new h(t),t.eat(")")),this.body=new T(t)}}class tt{constructor(t){a(this,"type","TryStatement");a(this,"block");a(this,"handler",null);a(this,"finalizer",null);var n,i,o,c;if(t.eat(e.TRY),this.block=new T(t),((n=t.lookahead)==null?void 0:n.type)!==e.CATCH&&((i=t.lookahead)==null?void 0:i.type)!==e.FINALLY)throw new Error("Expected Catch or Finally");((o=t.lookahead)==null?void 0:o.type)===e.CATCH&&(this.handler=new K(t)),((c=t.lookahead)==null?void 0:c.type)===e.FINALLY&&(t.eat(e.FINALLY),this.finalizer=new T(t))}}class et{constructor(t){a(this,"type","WithStatement");t.eat(e.WITH)}}class at{constructor(t){a(this,"type","ExpressionStatement");a(this,"expression");this.expression=new E(t)}}class w{constructor(t){var n;switch((n=t.lookahead)==null?void 0:n.type){case"{":{Object.assign(this,new T(t));break}case e.IF:{Object.assign(this,new g(t));break}case e.DO:case e.WHILE:case e.FOR:case e.SWITCH:{Object.assign(this,new Q(t));break}case e.CONTINUE:{Object.assign(this,new q(t));break}case e.BREAK:{Object.assign(this,new $(t));break}case e.RETURN:{Object.assign(this,new X(t));break}case e.WITH:{Object.assign(this,new et(t));break}case e.THROW:{Object.assign(this,new J(t));break}case e.TRY:{Object.assign(this,new tt(t));break}case e.DEBUGGER:{Object.assign(this,new Z(t));break}default:{Object.assign(this,new at(t));break}}}}class nt{constructor(t){a(this,"type","WhileStatement");a(this,"body");a(this,"test");var n;t.eat(e.WHILE),t.eat("("),this.test=new E(t),t.eat(")"),this.body=((n=t.lookahead)==null?void 0:n.type)==="{"?new T(t):new w(t)}}class st{constructor(t,n=!1){a(this,"type","VariableDeclarator");a(this,"id");a(this,"init",{type:"Literal",raw:"undefined"});var o;const i=new h(t);(n||((o=t.lookahead)==null?void 0:o.type)==="=")&&(t.eat("="),this.init=new E(t)),this.id=i}}class R{constructor(t){a(this,"type","VariableDeclaration");a(this,"declarations");a(this,"kind");var c,l,u;let n="var",i=!1;switch((c=t.lookahead)==null?void 0:c.type){case e.VAR:{t.eat(e.VAR),n="var";break}case e.LET:{t.eat(e.LET),n="let";break}case e.CONST:{t.eat(e.CONST),n="const",i=!0;break}default:throw new SyntaxError(`Unexpected token: "${(l=t.lookahead)==null?void 0:l.value}", expected a variable declarator!`)}const o=[];do o.push(new st(t,i));while(((u=t.lookahead)==null?void 0:u.type)===","&&t.eat(","));this.declarations=o,this.kind=n}}class it{constructor(t){a(this,"type","ForStatement");a(this,"init");a(this,"test");a(this,"update");a(this,"body");var i,o,c,l,u,d,b;t.eat(e.FOR);let n=!1;if(((i=t.lookahead)==null?void 0:i.type)===e.AWAIT&&(t.eat(e.AWAIT),n=!0),t.eat("("),!n&&((o=t.lookahead)==null?void 0:o.type)!==e.IN&&((c=t.lookahead)==null?void 0:c.type)!==e.OF){switch((l=t.lookahead)==null?void 0:l.type){case e.VAR:case e.LET:{this.init=new R(t);break}case e.CONST:throw new Error("Const declarations are not allowed in for loops");default:{this.init=new h(t);break}}t.eat(";"),this.test=new E(t),((u=t.lookahead)==null?void 0:u.type)===";"&&t.eat(";"),((d=t.lookahead)==null?void 0:d.type)!==")"&&(this.update=new E(t))}else throw new Error("For loop with in or of is not implemented");t.eat(")"),this.body=((b=t.lookahead)==null?void 0:b.type)==="{"?new T(t):new w(t)}}class L{constructor(t){var n;switch((n=t.lookahead)==null?void 0:n.type){case e.DO:{Object.assign(this,new z(t));break}case e.WHILE:{Object.assign(this,new nt(t));break}case e.FOR:{Object.assign(this,new it(t));break}}}}class ot{constructor(t,n){a(this,"type","LabelledStatement");a(this,"label");a(this,"body");this.label=n,t.eat(":"),this.body=new L(t)}}class ct{constructor(t){a(this,"type","ArrayExpression");a(this,"elements");var i,o;const n=[];for(t.eat("[");((i=t.lookahead)==null?void 0:i.type)!=="]";)n.push(new O(t).value),((o=t.lookahead)==null?void 0:o.type)!=="]"&&t.eat(",");t.eat("]"),this.elements=n}}class lt{constructor(t,n){a(this,"type","BinaryExpression");a(this,"left");a(this,"operator");a(this,"right");var i,o,c,l;switch(this.left=n??(((i=t.lookahead)==null?void 0:i.type)===e.IDENTIFIER?new h(t):new E(t)),(o=t.lookahead)==null?void 0:o.type){case"+":case"-":case"*":case"/":case"%":case"**":case"^":case">":case">>":case">>>":case"<":case"<<":case"<<<":case">=":case"<=":case"==":case"===":{this.operator=String(t.eat(String((c=t.lookahead)==null?void 0:c.type)).value);break}default:throw new Error("Invalid operator for BinaryExpression")}this.right=((l=t.lookahead)==null?void 0:l.type)===e.IDENTIFIER?new h(t):new E(t)}}class x{constructor(t,n){a(this,"type","AssignmentExpression");a(this,"left");a(this,"operator");a(this,"right");var i,o;this.left=n??(((i=t.lookahead)==null?void 0:i.type)===e.IDENTIFIER?new h(t):new E(t)),this.operator=String(t.eat("=").value),this.right=((o=t.lookahead)==null?void 0:o.type)===e.IDENTIFIER?new h(t):new E(t)}}class ut{constructor(t){a(this,"type","UpdateExpression");a(this,"operator");a(this,"argument");a(this,"prefix");var n,i,o;((n=t.lookahead)==null?void 0:n.type)==="++"||((i=t.lookahead)==null?void 0:i.type)==="--"?(this.prefix=!0,this.operator=String(t.eat(t.lookahead.type).value),this.argument=new h(t)):((o=t.lookahead)==null?void 0:o.type)===e.IDENTIFIER&&(this.argument=new h(t),this.prefix=!1,this.operator=String(t.eat(t.lookahead.type).value))}}class ht{constructor(t){a(this,"type","UnaryExpression");a(this,"operator");a(this,"prefix");a(this,"argument");var n,i;switch((n=t.lookahead)==null?void 0:n.type){case"delete":case"void":case"typeof":case"+":case"-":case"~":case"!":{this.operator=String(t.eat(String((i=t.lookahead)==null?void 0:i.type)).value),this.prefix=!0,this.argument=new E(t);break}}}}class Et{constructor(t,n){a(this,"type","LogicalExpression");a(this,"left");a(this,"operator");a(this,"right");var i,o,c,l;switch(this.left=n??(((i=t.lookahead)==null?void 0:i.type)===e.IDENTIFIER?new h(t):new E(t)),(o=t.lookahead)==null?void 0:o.type){case"??":case"||":case"&&":{this.operator=String(t.eat(String((c=t.lookahead)==null?void 0:c.type)).value);break}default:throw new Error("Invalid operator for LogicalExpression")}this.right=((l=t.lookahead)==null?void 0:l.type)===e.IDENTIFIER?new h(t):new E(t)}}class bt{constructor(t){a(this,"type","AwaitExpression");a(this,"argument");t.eat(e.AWAIT),this.argument=new E(t)}}class dt{constructor(t){a(this,"type","ThisExpression");t.eat(e.THIS)}}class B{constructor(t,n){a(this,"type","MemberExpression");a(this,"object");a(this,"property",null);a(this,"computed",!1);a(this,"optional",!1);var i,o,c;this.object=n;do switch((i=t.lookahead)==null?void 0:i.type){case"[":{t.eat("["),this.object=this.property?{...this}:{...this.object},this.property=new E(t),t.eat("]"),this.computed=!0;break}case".":{t.eat("."),this.object=this.property?{...this}:{...this.object},this.property=new h(t),this.computed=!1;break}}while(((o=t.lookahead)==null?void 0:o.type)==="."||((c=t.lookahead)==null?void 0:c.type)==="[")}}class kt{constructor(t){a(this,"type","ObjectExpression");a(this,"body",[]);var n,i,o,c,l,u,d;for(t.eat("{");((n=t.lookahead)==null?void 0:n.type)!=="}";){const b=((i=t.lookahead)==null?void 0:i.type)===e.GET;b&&t.eat(e.GET);const y=((o=t.lookahead)==null?void 0:o.type)===e.SET;y&&t.eat(e.SET);let f=!1,S=!1,I=null;!b&&!y&&(S=((c=t.lookahead)==null?void 0:c.type)===e.ASYNC,S&&t.eat(e.ASYNC),f=((l=t.lookahead)==null?void 0:l.type)==="[",f&&(t.eat("["),I=new h(t),t.eat("]"))),I===null&&(I=new h(t)),((u=t.lookahead)==null?void 0:u.type)==="("?this.body.push(new F(t,!1,S,f,I,b?"get":y?"set":"method")):this.body.push(new U(t,!1,f,I,":")),((d=t.lookahead)==null?void 0:d.type)!=="}"&&t.eat(",")}t.eat("}")}}class yt{constructor(t,n){a(this,"type","CallExpression");a(this,"callee");a(this,"arguments",[]);a(this,"optional",!1);var i;for(this.callee=n,t.eat("(");((i=t.lookahead)==null?void 0:i.type)!==")";)this.arguments.length>0&&t.eat(","),this.arguments.push(new E(t));t.eat(")")}}class E{constructor(t){var n,i,o,c;switch((n=t.lookahead)==null?void 0:n.type){case e.ASYNC:case e.FUNCTION:{Object.assign(this,new D(t));break}case"[":{Object.assign(this,new ct(t));break}case"{":{Object.assign(this,new kt(t));break}case e.NUMBER:case e.STRING:case e.BOOLEAN:case e.NAN:case e.NULL:case e.UNDEFINED:{Object.assign(this,new O(t));break}case"++":case"--":{Object.assign(this,new ut(t));break}case"delete":case"void":case"typeof":case"+":case"-":case"~":case"!":{Object.assign(this,new ht(t));break}case e.AWAIT:{Object.assign(this,new bt(t));break}case e.THIS:{Object.assign(this,new dt(t)),((i=t.lookahead)==null?void 0:i.type)==="."&&Object.assign(this,new B(t,this));break}case e.IDENTIFIER:{const l=new h(t);switch((o=t.lookahead)==null?void 0:o.type){case"+":case"-":case"*":case"/":case"%":case"**":case"^":case">":case">>":case">>>":case"<":case"<<":case"<<<":case">=":case"<=":case"==":case"===":{Object.assign(this,new lt(t,l));break}case"=":{Object.assign(this,new x(t,l));break}case"??":case"||":case"&&":{Object.assign(this,new Et(t,l));break}case":":{Object.assign(this,new ot(t,l));break}case"[":case".":{const u=new B(t,l);switch((c=t.lookahead)==null?void 0:c.type){case"=":{Object.assign(this,new x(t,u));break}case"(":{Object.assign(this,new yt(t,u));break}default:{Object.assign(this,u);break}}break}default:{Object.assign(this,l);break}}break}}}}class U{constructor(t,n,i,o,c="="){a(this,"type","PropertyDefinition");a(this,"static");a(this,"computed");a(this,"key");a(this,"value");var l;this.static=n,this.computed=i,this.key=o,((l=t.lookahead)==null?void 0:l.type)===c?(t.eat(c),this.value=new E(t)):this.value=null}}class Tt{constructor(t){a(this,"type","ClassBody");a(this,"body",[]);var n,i,o,c,l,u,d;for(t.eat("{");((n=t.lookahead)==null?void 0:n.type)!=="}";){const b=((i=t.lookahead)==null?void 0:i.type)===e.GET;b&&t.eat(e.GET);const y=((o=t.lookahead)==null?void 0:o.type)===e.SET;y&&t.eat(e.SET);let f=!1,S=!1,I=!1,A=null;!b&&!y&&(f=((c=t.lookahead)==null?void 0:c.type)===e.STATIC,f&&t.eat(e.STATIC),I=((l=t.lookahead)==null?void 0:l.type)===e.ASYNC,I&&t.eat(e.ASYNC),S=((u=t.lookahead)==null?void 0:u.type)==="[",S&&(t.eat("["),A=new h(t),t.eat("]"))),A===null&&(A=new h(t)),((d=t.lookahead)==null?void 0:d.type)==="("?this.body.push(new F(t,f,I,S,A,b?"get":y?"set":"method")):this.body.push(new U(t,f,S,A))}t.eat("}")}}class ft{constructor(t){a(this,"type","ClassDeclaration");a(this,"id");a(this,"superClass",null);a(this,"body");var n;t.eat(e.CLASS),this.id=new h(t),((n=t.lookahead)==null?void 0:n.type)==="("&&(t.eat("("),this.superClass=new h(t),t.eat(")")),this.body=new Tt(t)}}class It{constructor(t){a(this,"type","FunctionDeclaration");a(this,"id");a(this,"expression");a(this,"generator");a(this,"async");a(this,"params");a(this,"body");var u,d,b,y;let n=!1,i=!1;((u=t.lookahead)==null?void 0:u.type)===e.ASYNC&&(t.eat(e.ASYNC),n=!0),t.eat(e.FUNCTION),((d=t.lookahead)==null?void 0:d.type)==="*"&&(t.eat("*"),i=!0);const o=String(new h(t).name);t.eat("(");const c=[];for(;((b=t.lookahead)==null?void 0:b.type)!==")";)c.push(new h(t)),((y=t.lookahead)==null?void 0:y.type)!==")"&&t.eat(",");t.eat(")");const l=new T(t);this.id={type:e.IDENTIFIER,name:o},this.expression=!1,this.generator=i,this.async=n,this.params=c,this.body=l}}class Nt{constructor(t){var n;switch((n=t.lookahead)==null?void 0:n.type){case e.VAR:case e.LET:case e.CONST:{Object.assign(this,new R(t));break}case e.ASYNC:case e.FUNCTION:{Object.assign(this,new It(t));break}case e.CLASS:{Object.assign(this,new ft(t));break}}}}class St{constructor(t){var n;switch((n=t.lookahead)==null?void 0:n.type){case e.VAR:case e.LET:case e.CONST:case e.ASYNC:case e.FUNCTION:case e.CLASS:{Object.assign(this,new Nt(t));break}case e.IF:case e.DO:case e.WHILE:case e.FOR:case e.SWITCH:case e.CONTINUE:case e.BREAK:case e.RETURN:case e.WITH:case e.IDENTIFIER:case e.THROW:case e.TRY:case e.DEBUGGER:{Object.assign(this,new w(t));break}}}}class C{constructor(t,n){a(this,"body");var o,c,l;const i=[];for(;t.tokenizer.isEOF()===!1&&!(n!=null&&n.includes(String((o=t.lookahead)==null?void 0:o.type)));){const u=new St(t);for(u!==void 0&&i.push(u),((c=t.lookahead)==null?void 0:c.type)===";"&&t.eat(";");((l=t.lookahead)==null?void 0:l.type)===";";)i.push(new H(t))}this.body=i}}class wt{constructor(t){a(this,"type","Program");a(this,"body");this.body=new C(t).body}}class v{constructor(){a(this,"syntax");a(this,"tokenizer");a(this,"lookahead");this.syntax="",this.tokenizer=new m(this),this.lookahead=null}parse(t){return this.lookahead=null,this.syntax="",this.syntax=t,this.tokenizer=new m(this),this.lookahead=this.tokenizer.getNextToken(),new wt(this)}eat(t){const n=this.lookahead;if(n===null)throw new SyntaxError(`Unexpected end of input, expected: "${t}"`);if(n.type!==t)switch(t){case e.IDENTIFIER:throw new SyntaxError(`Unexpected token: "${n.value}", cannot use keyword "${n.value}" for the beginning of the identifer`);default:throw new SyntaxError(`Unexpected token: "${n.value}", expected: "${t}"`)}return this.lookahead=this.tokenizer.getNextToken(t===e.IDENTIFIER),n}}const j=new v;typeof window<"u"&&(customElements.define("vi-script",class extends HTMLElement{constructor(){super()}connectedCallback(){setTimeout(()=>{var s;(s=this.childNodes.item(0).textContent)==null||s.trim(),this.innerHTML=""})}}),window.VietScript={parser:j}),k.Parser=v,k.Tokenizer=m,k.default=j,Object.defineProperties(k,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
